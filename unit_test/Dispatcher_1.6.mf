; Dispatcher_1.6.mf
; 18-649 Distributed Embedded Systems
; Group 11
; Rahul Ramesh // rahulram. Daniel Santoro // ddsantor. David Thompson // davidtho. Jialiang Tan // jialiant
; !@

; Unit test for Dispatcher
; Jialiang Tan


#INCLUDE defines.mf

;#state 'SAFETY'
+0.5s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getFloor == 1
+0s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == STOP
+0s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getHallway == NONE

;#transition 'PT0'
+0.5s I AT_FLOOR_PERIOD N AT_FLOOR_[1][FRONT]_CAN_ID AtFloor 1 FRONT = TRUE
+0ms I DRIVE_PERIOD N DRIVE_SPEED_CAN_ID DriveSpeed = 0 STOP
+0ms I CAR_LEVEL_POSITION_PERIOD N CAR_LEVEL_POSITION_CAN_ID CarLevelPosition = 0
+0ms I DOOR_CONTROL_PERIOD N DOOR_MOTOR_COMMAND_[FRONT][LEFT]_CAN_ID DoorMotorCommand FRONT LEFT = MDOOR_STOP
+0ms I DOOR_CONTROL_PERIOD N DOOR_MOTOR_COMMAND_[FRONT][RIGHT]_CAN_ID DoorMotorCommand FRONT RIGHT = MDOOR_STOP
+0ms I DOOR_CONTROL_PERIOD N DOOR_MOTOR_COMMAND_[BACK][LEFT]_CAN_ID DoorMotorCommand BACK LEFT = MDOOR_STOP
+0ms I DOOR_CONTROL_PERIOD N DOOR_MOTOR_COMMAND_[BACK][RIGHT]_CAN_ID DoorMotorCommand BACK RIGHT = MDOOR_STOP
+0s I DOOR_CONTROL_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][LEFT]_CAN_ID DoorClosed FRONT LEFT = TRUE
+0s I DOOR_CONTROL_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][RIGHT]_CAN_ID DoorClosed FRONT RIGHT = TRUE
+0s I DOOR_CONTROL_PERIOD N DOOR_CLOSED_SENSOR_[BACK][LEFT]_CAN_ID DoorClosed BACK LEFT = TRUE
+0s I DOOR_CONTROL_PERIOD N DOOR_CLOSED_SENSOR_[BACK][RIGHT]_CAN_ID DoorClosed BACK RIGHT = TRUE

;#state 'STOP'
+0.5s A N AT_FLOOR_[1][FRONT]_CAN_ID AtFloor 1 FRONT : getValue == TRUE
+0s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getFloor == 0
+0s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == STOP
+0s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getHallway == NONE

;#transition 'PT4'
+0.5s I HALL_BUTTON_CONTROL_PERIOD N HALL_CALL_[3][FRONT][UP]_CAN_ID HallCall 3 FRONT UP = TRUE
+0s I DOOR_CONTROL_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][LEFT]_CAN_ID DoorClosed FRONT LEFT = TRUE
+0s I DOOR_CONTROL_PERIOD N DOOR_CLOSED_SENSOR_[FRONT][RIGHT]_CAN_ID DoorClosed FRONT RIGHT = TRUE
+0s I DOOR_CONTROL_PERIOD N DOOR_CLOSED_SENSOR_[BACK][LEFT]_CAN_ID DoorClosed BACK LEFT = TRUE
+0s I DOOR_CONTROL_PERIOD N DOOR_CLOSED_SENSOR_[BACK][RIGHT]_CAN_ID DoorClosed BACK RIGHT = TRUE

;#state 'MOVE_CAR_CALL'
+0.5s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getFloor == 3
+0s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == UP
+0s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getHallway == FRONT

;#transition 'PT7'
;desiredDirection and driveDirection now should both be UP
+0s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == UP

;#state 'MOVE_ALL'
+0.5s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getFloor == 3
+0s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getDirection == UP
+0s A N DESIRED_FLOOR_CAN_ID DesiredFloor : getHallway == FRONT






